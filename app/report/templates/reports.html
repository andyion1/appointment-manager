{% extends "base.html" %}

{% block title %}My Reports{% endblock %}

{% block content %}
<h2>My Reports</h2>

<div class="action-buttons">
    {% if current_user.role in ['student', 'teacher'] %}
    <a href="{{ url_for('appointment.appointments') }}" class="submit-button primary-button">View Appointments</a>
    {% endif %}
</div>

{% if reports %}
<div class="appointments-grid">
    {% for report in reports %}
    <div class="appointment-card">
        <div class="appointment-card-header">
            <h3>Report #{{ report.report_id }}</h3>
            <span class="detail-value">{{ report.created_at.strftime("%Y-%m-%d %H:%M:%S") if report.created_at else "N/A" }}</span>
        </div>
        <div class="appointment-card-content">
            <div class="appointment-card-detail">
                <span class="detail-label">Student:</span>
                <span class="detail-value">{{ report.student_name or 'N/A' }}</span>
            </div>
            <div class="appointment-card-detail">
                <span class="detail-label">Teacher:</span>
                <span class="detail-value">{{ report.teacher_name or 'N/A' }}</span>
            </div>
            <div class="appointment-card-detail appointment-card-reason">
                <span class="detail-label">Feedback:</span>
                <span class="detail-value">{{ report.feedback or 'No feedback provided' }}</span>
            </div>
            {% if report.teacher_response %}
            <div class="appointment-card-detail appointment-card-reason">
                <span class="detail-label">Response:</span>
                <span class="detail-value">{{ report.teacher_response }}</span>
            </div>
            {% endif %}
        </div>
        <div class="appointment-card-footer">
            <a href="{{ url_for('report.report', report_id=report.report_id) }}" class="button-link">View Full Report</a>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="no-appointments">
    <p>No reports found.</p>
    <p>Reports are created after appointments are completed.</p>
</div>
{% endif %}
{% endblock %}