{% extends "base.html" %}

{% block title %}Appointment Details{% endblock %}

{% block content %}
<div class="appointment-details">
    <h2>Appointment #{{ appointment.appointment_id }}</h2>
    
    <div class="appointment-info">
        <div class="appointment-status">
            <span class="status-badge {{ appointment.status }}">{{ appointment.status }}</span>
        </div>
        
        <div class="appointment-datetime">
            <p><strong>Date:</strong> {{ appointment.appointment_date.strftime('%Y-%m-%d') }}</p>
            <p><strong>Time:</strong> {{ appointment.appointment_time.strftime('%H:%M') }}</p>
        </div>
        
        <div class="appointment-participants">
            <p><strong>Student:</strong> {{ student.full_name }} ({{ student.program }})</p>
            <p><strong>Teacher:</strong> {{ teacher.full_name }} ({{ teacher.department }})</p>
        </div>
        
        <div class="appointment-reason">
            <h3>Reason:</h3>
            <p>{{ appointment.reason }}</p>
        </div>
        
        <div class="appointment-metadata">
            <p><strong>Created at:</strong> {{ appointment.created_at.strftime('%Y-%m-%d %H:%M') }}</p>
        </div>
    </div>
    
    {% if current_user.role == 'teacher' or current_user.role in ['admin_appoint', 'admin_super'] %}
    <div class="appointment-actions">
        <h3>Update Status</h3>
        <form method="POST" action="{{ url_for('appointment.update_status', appointment_id=appointment.appointment_id) }}">
            {{ status_form.hidden_tag() }}
            <div class="form-group">
                {{ status_form.status.label(class="form-label") }}
                {{ status_form.status(class="form-control") }}
            </div>
            <div class="form-group">
                {{ status_form.submit(class="submit-button") }}
            </div>
        </form>
    </div>
    {% endif %}
    
    {% if current_user.role in ['admin_appoint', 'admin_super'] %}
    <div class="admin-actions">
        <form method="POST" action="{{ url_for('appointment.delete_appointment', appointment_id=appointment.appointment_id) }}" onsubmit="return confirm('Are you sure you want to delete this appointment?');">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <button type="submit" class="danger-button">Delete Appointment</button>
        </form>
    </div>
    {% endif %}
    
    <div class="back-link">
        <a href="{{ url_for('appointment.appointments') }}">Back to Appointments</a>
    </div>
</div>
{% endblock %}